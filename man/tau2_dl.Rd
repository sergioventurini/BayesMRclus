% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estim.R
\name{tau2_dl}
\alias{tau2_dl}
\title{Compute DerSimonian-Laird Tau-Squared Estimate}
\usage{
tau2_dl(data, secondorder = TRUE, beta_max = NULL, se_max = NULL)
}
\arguments{
\item{data}{A matrix or data frame with 4 columns:
\describe{
\item{Column 1}{Estimated genetic associations with the exposure (\code{gammaj_hat})}
\item{Column 2}{Estimated genetic associations with the outcome (\code{Gammaj_hat})}
\item{Column 3}{Standard errors of exposure associations (\code{sigmaj_X})}
\item{Column 4}{Standard errors of outcome associations (\code{sigmaj_Y})}
}
Each row represents a different genetic variant.}

\item{secondorder}{Length-one logical vector indicating whether to apply a second
order delta method expansion for the variance of a ratio. Default to \code{TRUE}.}

\item{beta_max}{Length-one numeric vector representing the maximum Wald ratio value
to use. That is, all the genetic variants whose Wald ratio will be (in absolute
terms) larger than \code{beta_max} will be removed before computing the
DerSimonian-Laird estimate.}

\item{se_max}{Length-one numeric vector representing the maximum Wald ratio standard
error to use. That is, all the genetic variants whose Wald ratio standard error
will be (in absolute terms) larger than \code{se_max} will be removed before
computing the DerSimonian-Laird estimate.}
}
\value{
A list that contains the DerSimonian-Laird estimate of tau-squared, the Wald
ratio estimates and the corresponding standard errors.
}
\description{
Calculates the DerSimonian-Laird estimate of the between-study variance
(tau-squared) for meta-analysis of Mendelian randomization studies.
}
\details{
This function implements the DerSimonian-Laird method for estimating
heterogeneity in meta-analysis, adapted for Mendelian randomization studies.
The causal effect estimates (beta) and their variances are calculated using
the ratio method as described in Burgess and Thompson (2021), equation (4.5).

The method-of-moments estimator is based on Cochran's Q statistic and is
truncated at zero to ensure non-negative variance estimates.
}
\examples{
# Example data for 5 genetic variants
example_data <- matrix(c(
  0.15, 0.10, 0.02, 0.03,
  0.20, 0.15, 0.03, 0.04,
  0.12, 0.09, 0.02, 0.03,
  0.18, 0.12, 0.03, 0.04,
  0.25, 0.18, 0.04, 0.05
), ncol = 4, byrow = TRUE)

tau2_dl(example_data)

}
\references{
Burgess S, Thompson SG (2021). Mendelian Randomization: Methods for Causal
Inference Using Genetic Variants, 2nd edition. Chapman and Hall/CRC.
}
